<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>assocTest-aggregateFile — assocTest-aggregateFile • rvat</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="assocTest-aggregateFile — assocTest-aggregateFile"><meta property="og:description" content="Run assocTest on a aggregateFile object.
See the main assocTest page for details."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rvat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/basics.html">Getting started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basics.html">Getting started</a>
    </li>
    <li>
      <a href="../articles/association_testing.html">Association testing</a>
    </li>
    <li>
      <a href="../articles/explore_visualize_results.html">Visualization</a>
    </li>
    <li>
      <a href="../articles/variant_annotation.html">Variant annotation</a>
    </li>
    <li>
      <a href="../articles/GSA.html">Gene set analysis</a>
    </li>
    <li>
      <a href="../articles/spatial_clustering.html">Spatial clustering</a>
    </li>
    <li>
      <a href="../articles/cmdline.html">Command-line tool</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/changelog.html">Changelog</a>
</li>
<li>
  <a href="../articles/faq.html">F.A.Q.</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/KennaLab/rvat" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>assocTest-aggregateFile</h1>
    
    <div class="hidden name"><code>assocTest-aggregateFile.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Run <code><a href="assocTest.html">assocTest</a></code> on a <code><a href="aggregateFile.html">aggregateFile</a></code> object.
See the main <code><a href="assocTest.html">assocTest</a></code> page for details.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for aggregateFile</span></span>
<span><span class="fu"><a href="assocTest.html">assocTest</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">pheno</span>,</span>
<span>  <span class="va">test</span>,</span>
<span>  <span class="va">geneSet</span>,</span>
<span>  <span class="va">gdb</span>,</span>
<span>  cohort <span class="op">=</span> <span class="st">"SM"</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  continuous <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  covar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  substractCovar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dropUnits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxitFirth <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  strict <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>a <code><a href="aggregateFile.html">aggregateFile</a></code> object (generated using the <code><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></code> method).</p></dd>


<dt>pheno</dt>
<dd><p>field to test as response variable, the response variable
can either be binary (0/1) or continuous. If the response variable is continuous set
<code>continuous</code> to <code>TRUE</code>.</p></dd>


<dt>test</dt>
<dd><p>Vector of statistical tests to run,
options include firth,glm,lm, and nbinom.</p></dd>


<dt>geneSet</dt>
<dd><p>a <code><a href="geneSetList.html">geneSetList</a></code> or <code><a href="geneSetFile.html">geneSetFile</a></code> object</p></dd>


<dt>gdb</dt>
<dd><p>a <code><a href="gdb.html">gdb</a></code> object, this will be used to load the cohort data.</p></dd>


<dt>cohort</dt>
<dd><p>Cohort name (present in the gdb)</p></dd>


<dt>name</dt>
<dd><p>Optional name of the analysis.</p></dd>


<dt>continuous</dt>
<dd><p>Is the response variable continuous? (TRUE/FALSE). Defaults to <code>FALSE</code>.</p></dd>


<dt>covar</dt>
<dd><p>Character vector of covariates, or list with multiple sets of covariates.</p></dd>


<dt>substractCovar</dt>
<dd><p>Covariate from which aggregate should be substracted.
Useful when adjusting for total variant counts, by specifying the total variant count variable
here, the aggregate score of the gene set tested will be substracted from the total count variable.</p></dd>


<dt>dropUnits</dt>
<dd><p>Optional, vector of units to exclude.</p></dd>


<dt>maxitFirth</dt>
<dd><p>Maximum number of iterations to use for estimating firth confidence intervals.</p></dd>


<dt>keep</dt>
<dd><p>vector of sample IDs to keep, defaults to <code>NULL</code>, in which case all samples are kept.
Defaults to <code>FALSE</code>.</p></dd>


<dt>output</dt>
<dd><p>Output file path for results.
Defaults to <code>NULL</code>, in which case results are not written but returned as a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code>.</p></dd>


<dt>verbose</dt>
<dd><p>Should the function be verbose? (TRUE/FALSE), defaults to <code>TRUE</code>.</p></dd>


<dt>strict</dt>
<dd><p>Should strict checks be performed? Defaults to <code>TRUE</code>. Strict tests currently includes
checking whether supplied aggregateFile was generated from the same gdb as specified in <code>gdb</code>.</p></dd>

</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rvatData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="gdb.html">gdb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/rvatData/man/rvat_example.html" class="external-link">rvat_example</a></span><span class="op">(</span><span class="st">"rvatData.gdb"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># assocTest-aggregateFile allows for running association tests on pre-constructed aggregates.</span></span></span>
<span class="r-in"><span><span class="co"># below we first generate the aggregates based on a varSetFile</span></span></span>
<span class="r-in"><span><span class="va">varsetfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="varSetFile.html">varSetFile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/rvatData/man/rvat_example.html" class="external-link">rvat_example</a></span><span class="op">(</span><span class="st">"rvatData_varsetfile.txt.gz"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">varset</span> <span class="op">&lt;-</span> <span class="fu"><a href="getVarSet.html">getVarSet</a></span><span class="op">(</span><span class="va">varsetfile</span>, unit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NEK1"</span>, <span class="st">"SOD1"</span>, <span class="st">"ABCA4"</span><span class="op">)</span>, varSetName <span class="op">=</span> <span class="st">"High"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">aggfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdb</span>,</span></span>
<span class="r-in"><span>          varSet <span class="op">=</span> <span class="va">varset</span>,</span></span>
<span class="r-in"><span>          maxMAF <span class="op">=</span> <span class="fl">0.001</span>,</span></span>
<span class="r-in"><span>          output <span class="op">=</span> <span class="va">aggfile</span>,</span></span>
<span class="r-in"><span>          verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># connect to aggregateFile, see ?aggregateFile for more details</span></span></span>
<span class="r-in"><span><span class="va">aggregatefile</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregateFile.html">aggregateFile</a></span><span class="op">(</span><span class="va">aggfile</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># build an example genesetlist, see ?buildGeneSet for details</span></span></span>
<span class="r-in"><span><span class="va">genesetlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="buildGeneSet.html">buildGeneSet</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"geneset1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SOD1"</span>, <span class="st">"NEK1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       <span class="st">"geneset2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ABCA4"</span>, <span class="st">"SOD1"</span>, <span class="st">"NEK1"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># perform association tests using assocTest</span></span></span>
<span class="r-in"><span><span class="co"># note that this is very similar to running association tests on a genoMatrix (?`assocTest-genoMatrix`)</span></span></span>
<span class="r-in"><span><span class="co"># or on a gdb (?`assocTest-gdb`). The main difference being that pre-constructed aggregates are used from </span></span></span>
<span class="r-in"><span><span class="co"># the aggregateFile, and requires a genesetFile/geneSetList (?geneSetFile) to be provided to the `geneSet` argument.</span></span></span>
<span class="r-in"><span><span class="va">aggAssoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="assocTest.html">assocTest</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">aggregatefile</span>,</span></span>
<span class="r-in"><span>  gdb <span class="op">=</span> <span class="va">gdb</span>,</span></span>
<span class="r-in"><span>  test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glm"</span>, <span class="st">"firth"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  cohort <span class="op">=</span> <span class="st">"pheno"</span>,</span></span>
<span class="r-in"><span>  pheno <span class="op">=</span> <span class="st">"pheno"</span>,</span></span>
<span class="r-in"><span>  geneSet <span class="op">=</span> <span class="va">genesetlist</span>,</span></span>
<span class="r-in"><span>  covar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"PC"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kevin Kenna, Paul Hop.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

